---
interface Props {
  currentPage: number;
  totalPages: number;
  basePath: string;
}

const { currentPage, totalPages, basePath } = Astro.props;

const prevPage = currentPage > 1 ? currentPage - 1 : null;
const nextPage = currentPage < totalPages ? currentPage + 1 : null;

function getPageUrl(page: number): string {
  if (page === 1) return basePath;
  return `${basePath}/${page}`;
}

// Generate page numbers to show
const pages: (number | 'ellipsis')[] = [];
const showEllipsisStart = currentPage > 3;
const showEllipsisEnd = currentPage < totalPages - 2;

if (totalPages <= 7) {
  // Show all pages
  for (let i = 1; i <= totalPages; i++) {
    pages.push(i);
  }
} else {
  // Always show first page
  pages.push(1);
  
  if (showEllipsisStart) {
    pages.push('ellipsis');
  }
  
  // Show pages around current
  const start = Math.max(2, currentPage - 1);
  const end = Math.min(totalPages - 1, currentPage + 1);
  
  for (let i = start; i <= end; i++) {
    if (!pages.includes(i)) {
      pages.push(i);
    }
  }
  
  if (showEllipsisEnd) {
    pages.push('ellipsis');
  }
  
  // Always show last page
  if (!pages.includes(totalPages)) {
    pages.push(totalPages);
  }
}
---

<nav class="flex items-center justify-center gap-2 mt-12" aria-label="Pagination">
  {prevPage ? (
    <a
      href={getPageUrl(prevPage)}
      class="px-3 py-2 text-sm font-medium rounded-lg border border-border-light dark:border-border-dark hover:bg-zinc-50 dark:hover:bg-zinc-800 transition-colors"
      aria-label="Previous page"
    >
      <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
      </svg>
    </a>
  ) : (
    <span class="px-3 py-2 text-sm font-medium rounded-lg border border-border-light dark:border-border-dark opacity-50 cursor-not-allowed">
      <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
      </svg>
    </span>
  )}

  {pages.map((page) => (
    page === 'ellipsis' ? (
      <span class="px-2 text-text-muted-light dark:text-text-muted-dark">...</span>
    ) : page === currentPage ? (
      <span class="px-3 py-2 text-sm font-medium rounded-lg bg-zinc-900 text-white dark:bg-white dark:text-zinc-900">
        {page}
      </span>
    ) : (
      <a
        href={getPageUrl(page)}
        class="px-3 py-2 text-sm font-medium rounded-lg border border-border-light dark:border-border-dark hover:bg-zinc-50 dark:hover:bg-zinc-800 transition-colors"
      >
        {page}
      </a>
    )
  ))}

  {nextPage ? (
    <a
      href={getPageUrl(nextPage)}
      class="px-3 py-2 text-sm font-medium rounded-lg border border-border-light dark:border-border-dark hover:bg-zinc-50 dark:hover:bg-zinc-800 transition-colors"
      aria-label="Next page"
    >
      <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
      </svg>
    </a>
  ) : (
    <span class="px-3 py-2 text-sm font-medium rounded-lg border border-border-light dark:border-border-dark opacity-50 cursor-not-allowed">
      <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
      </svg>
    </span>
  )}
</nav>
