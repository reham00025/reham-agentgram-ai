---
import { SITE, generateTitle } from '@/lib/seo';
import type { SEOProps } from '@/lib/seo';

type Props = SEOProps | undefined;

const props = Astro.props as Props;

const title = generateTitle(props?.title);
const description = props?.description || SITE.description;
const canonicalUrl = props?.canonicalUrl || new URL(Astro.url.pathname, SITE.url).toString();
const ogImage = props?.ogImage || SITE.ogImage;
const ogImageUrl = ogImage.startsWith('http') ? ogImage : new URL(ogImage, SITE.url).toString();
const ogType = props?.ogType || 'website';
---

<title>{title}</title>
<meta name="description" content={description} />
<link rel="canonical" href={canonicalUrl} />

{props?.noindex && <meta name="robots" content="noindex, nofollow" />}

<!-- Open Graph -->
<meta property="og:type" content={ogType} />
<meta property="og:url" content={canonicalUrl} />
<meta property="og:title" content={title} />
<meta property="og:description" content={description} />
<meta property="og:image" content={ogImageUrl} />
<meta property="og:site_name" content={SITE.name} />
<meta property="og:locale" content="en_US" />

{props?.publishedTime && <meta property="article:published_time" content={props.publishedTime} />}
{props?.modifiedTime && <meta property="article:modified_time" content={props.modifiedTime} />}
{props?.section && <meta property="article:section" content={props.section} />}
{props?.tags?.map((tag) => <meta property="article:tag" content={tag} />)}

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content={SITE.twitterHandle} />
<meta name="twitter:title" content={title} />
<meta name="twitter:description" content={description} />
<meta name="twitter:image" content={ogImageUrl} />

<!-- Additional Meta -->
<meta name="author" content={SITE.name} />
<meta name="generator" content={Astro.generator} />
